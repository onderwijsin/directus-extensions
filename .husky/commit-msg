#!/bin/bash

# Read the commit message
COMMIT_MSG_FILE="$1"
COMMIT_MSG=$(cat "$COMMIT_MSG_FILE")

# Use sed to capture <type>(<scope>) if present, and the subject separately
UPDATED_MSG=$(echo "$COMMIT_MSG" | sed -E 's/^([a-z]+(\([^)]+\))?: )(.+)/\1\U\3/')

# Overwrite the commit message with the corrected version
echo "$UPDATED_MSG" > "$COMMIT_MSG_FILE"

# Run commitlint
pnpm commitlint --edit "$COMMIT_MSG_FILE"